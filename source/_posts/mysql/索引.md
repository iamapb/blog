---
layout: mysql
title: 索引
date: 2021-08-15 17:12:59
tags: mysql
---

### mysql有多种索引类型，使用不同的角度，分类也有所不同

### 1 从数据结构角度，可分为
```java
  B+树索引 hash索引 空间数据索引 全文索引
  innodb中支持

```

   
  
### 2 从数据结构角度，可分为

```xml

   普通索引: 基础的索引，没有任务约束,主要是提高查询的效率。 create index index_name on table(column(length)
   
   唯一索引: 在普通索引的基础上增加了数据唯一性的约束，索引列的值必须唯一。允许有null值.如果一个唯一索引同时还有组合索引，那么表示列值的组合
   必须唯一。
   主键索引: 特殊的唯一索引，不允许有null值，并且一张表最多有一个主键索引.
   组合索引: 多个字段上创建的索引，使用组合索引时需要遵循最左前缀原则，查询的时候必须要从左向右匹配
   索引覆盖: 索引的叶子节点包含了要查询的数据
   
   (最左前缀原则：索引按照最左优先的方式匹配索引。比如创建一个组合索引(name1, name2, namer) 查询条件:
   例1 where name1 = 1, 
   where name1 = 1 and name2 =2 and name3 = 3 都可以使用该索引
   例2 where name2 = 2 , where name1 = 2 and name3 = 4 就不匹配 
   例3 where name1 like '张%', 可以使用索引
   例4 where name1 like '%张%' 索引不起效果
```



### 3 从物理存储角度，可分为

```
    
   1 聚簇索引: 叶子节点就是数据节点，innodb 使用该索引 
   innodb支持聚簇索引和非聚簇索引
   innode存储引擎中，数据在进行插入的时候，数据必须跟某一个索引列绑定在一起，
   如果表中有主键，那么跟主键绑定，
   如果没有主键，跟唯一键绑定，如果没有唯一键，选择一个6字节的rowid进行绑定

   二级索引: 一个表有n个索引，每一个索引都是一个B+，表中的数据是存储一份的，数据是存储在聚簇索引的叶子节点，其他非聚簇索引的叶子节点存储的是key的值

   innodb中的非聚簇索引都可以称为二级索引或者辅助索引

   2 非聚簇索引: 叶子节点不存储数据，而是指向对应数据库的指针

```
聚族索引示意图
![数据类型](/../../static/mysql/B+树示意图.png)

聚族和非聚族示意图
![数据类型](/../../static/mysql/聚族和非聚族原理图.png) 

### 4 mysql索引失效的情况

  
> 1.like 以 %开头，索引无效; like 前缀没有%, 后缀有%时候，索引有 

![mysql索引失效1](/../../static/mysql/mysql索引失效1.jpg)
 > 2.or语句前后没有同时使用索引。当or左右查询字段只有一个是索引，该索引失效，只有当or左右查询字段均为索引时，才会生效
 >3 组合索引，不使用第一列索引，索引失效
 >4 在索引列上使用 IS NULL 或 IS NOT NULL操作，索引不一定失效
 >5 在使用组合索引的时候，如果中间的某个索引列使用了范围查询，那么会导致后续的索引失效
 >6 索引出现函数计算

### 5 索引优化的时候要注意
> 1 索引字段要尽可能少的占用存储空间
> 2 在满足业务需求内尽可能自增
> 3 索引字段尽可能不要为null
> 4 索引不是越多越好
> 5 索引字段尽量不要频繁修改